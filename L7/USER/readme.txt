changes made to u1, ucode, mkallu from kc's code
